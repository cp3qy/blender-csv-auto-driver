# Blender CSV 自动驱动插件

**适用环境：** Blender 3.0 ~ 4.x

---

## 简介

插件功能：直接读取 CSV 数据文件，根据时间轴上的数值变化，一键驱动场景中物体的**灯光、颜色、位置和纹理(UV)**动画。

**版本更新：**

- ✅ **自定义颜色：** 不再强制变白，支持自定义“起始色”到“结束色”的渐变（如红变蓝）。
- ✅ **全轴向解锁：** 物体位置支持 X、Y、Z 独立驱动；UV 支持横向(X)和纵向(Y)流动。
- ✅ **多通道叠加：** 支持对同一个物体同时驱动多种属性（如：灯光既闪烁又变色）。
- ✅ **相对位置模式 (v4.1新增)：** 位置驱动现在基于物体初始位置偏移，不再跳到0坐标。
- ✅ **旋转驱动 (v4.1新增)：** 支持绕 X、Y、Z 轴旋转，同样基于初始角度偏移。

---

## 安装方法

1. 打开 Blender。
2. 点击顶部菜单 **编辑 (Edit)** -> **偏好设置 (Preferences)**。
3. 选择左侧的 **插件 (Add-ons)** 栏目。
4. 点击右上角的 **安装 (Install...)** 按钮。
5. 选择提供的 `csv_auto_driver.py` 文件并安装。
6. 勾选插件名称前面的复选框以启用。
7. 安装完成后，按键盘 **N** 键打开侧边栏，你会在 **"CSV Driver"** 标签页找到它。

---

## 使用前必读 (关键设置)

为了确保动画与数据对齐，请检查：

1.  **帧率设置：** 建议将场景帧率设置为 **30 FPS** (对应 CSV 80秒 = 2400帧)。
2.  **材质要求：**
    - 如果要驱动**物体颜色**，请确保物体已有材质，且使用的是“原理化 BSDF”节点。
    - 如果要驱动**UV贴图**，请确保材质节点中连接了 **"Mapping" (映射)** 节点。
3.  **多物体驱动技巧：** 如果多个物体共享同一个材质（如场景中的长条），只需对其中**一个**物体生成动画，所有物体都会同步变化。

---

## 操作指南

### 1. 数据源

点击文件夹图标，加载 `.csv` 数据文件。

### 2. 参数设置

- **列号：** 默认为 1（代表数据在表格的第 2 列）。如果有多个数据列，请根据需要修改。
- **帧偏移 (后悔药功能)：**
  - 填 `0`：严格按 CSV 时间。
  - 填 `-5`：动画**提前** 5 帧。
  - 填 `10`：动画**推后** 10 帧 (用于对齐音乐卡点)。

### 3. 强度控制 (必填)

由于 CSV 原始数值较小 (约 0.08)，**必须设置倍数**才能看到明显效果：

| 驱动类型          | 推荐倍数       | 效果说明                                       |
| :---------------- | :------------- | :--------------------------------------------- |
| **💡 灯光功率**   | **500 ~ 1000** | 让灯光达到正常的瓦数亮度。                     |
| **🎨 自定义颜色** | **5 ~ 10**     | 让数值落在 0~1 之间，实现双色渐变。            |
| **⬆️ 物体位置**   | **2 ~ 5**      | 控制物体跳动的高度/距离（基于初始位置偏移）。  |
| **🔄 物体旋转**   | **10 ~ 50**    | 控制旋转幅度（单位：弧度，基于初始角度偏移）。 |
| **🌊 UV 贴图**    | **5 ~ 10**     | 让纹理流动更明显。                             |

### 4. 颜色自定义 (仅限颜色模式)

点击面板上的色块，设置想要的渐变色：

- **起始色：** 当数值为 0 时显示的颜色（如红色）。
- **结束色：** 当数值为 1 时显示的颜色（如蓝色）。
- _插件会自动计算中间的过渡色。_

### 5. 驱动目标 & 生成

选中物体，选择功能，点击 **“开始生成动画”**。
_(生成后请将时间轴拖动到 80秒/2400帧 以后查看效果)_

---

## Q&A

**Q: 如何让一个灯光既闪烁又变色？(多通道叠加)**
A: 分两步走：

1.  选中灯光，模式选 **“灯光功率”**，设置倍数 1000，点生成。
2.  **不要取消选中**，模式改选 **“灯光颜色”**，设置倍数 10，点生成。
3.  完成，灯光拥有了双重动画。

**Q: 如何分别用两条数据控制两个物体？**
A: 分两步走：

1.  选中物体 A -> 填 **列号 1** -> 点生成。
2.  选中物体 B -> 填 **列号 2** -> 点生成。
    它们互不干扰。

**Q: 为什么 UV 动了但看不出来？**
A: 如果材质纹理非常均匀（如纯色透纱），肉眼很难分辨位移。建议暂时换成有图案的纹理（如棋盘格）来预览效果，确认动起来后再换回原材质。

**Q: 颜色一直显示为结束色（如一直绿），没有渐变？**
A: 说明**强度倍数太大**了（导致数值一直大于1）。请尝试把倍数改小（例如从 20 改为 5），就能看到中间的渐变色了。
